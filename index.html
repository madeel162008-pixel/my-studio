<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Live Inventory Dashboard</title>
    <style>
        body { font-family: 'Segoe UI', sans-serif; background: #f0f2f5; margin: 0; padding: 20px; text-align: center; }
        .header { background: white; padding: 20px; border-radius: 15px; box-shadow: 0 4px 10px rgba(0,0,0,0.1); margin-bottom: 30px; }
        .logo { width: 140px; margin-bottom: 10px; cursor: pointer; }
        
        /* Admin Section - Hidden by default */
        #loginArea { display: none; margin: 15px auto; padding: 15px; background: #f8f9fa; border-radius: 10px; max-width: 300px; border: 1px solid #ddd; }
        #adminPanel { display: none; background: #fff; padding: 25px; margin: 20px auto; max-width: 450px; border-radius: 12px; border: 2px solid #34495e; box-shadow: 0 10px 20px rgba(0,0,0,0.1); }
        
        input, select { width: 90%; padding: 12px; margin: 10px 0; border: 1px solid #ddd; border-radius: 8px; font-size: 16px; }
        .btn-main { padding: 12px 25px; background: #2c3e50; color: white; border: none; cursor: pointer; border-radius: 8px; font-weight: bold; width: 100%; }
        
        .grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 25px; max-width: 1200px; margin: 0 auto; }
        .card { background: white; padding: 15px; border-radius: 15px; box-shadow: 0 5px 15px rgba(0,0,0,0.05); transition: 0.3s; text-align: left; display: flex; flex-direction: column; min-height: 400px; }
        .card:hover { transform: translateY(-5px); }
        
        .product-img { width: 100%; height: 220px; object-fit: cover; border-radius: 10px; margin-bottom: 15px; }
        .price { color: #e67e22; font-size: 20px; font-weight: bold; margin: 10px 0; }
        .status-tag { font-size: 11px; padding: 4px 10px; border-radius: 20px; background: #eee; align-self: flex-start; margin-bottom: 5px; }
        
        .btn-order { background: #ff4747; color: white; text-decoration: none; padding: 12px; border-radius: 8px; text-align: center; font-weight: bold; margin-top: auto; display: block; }
        .btn-order:hover { background: #e03636; }
    </style>
</head>
<body>

    <div class="header">
        <img src="https://i.postimg.cc/CLbXCCP1/ei-1771101710052-removebg-preview.png" alt="Logo" class="logo" onclick="toggleLogin()">
        <h1>Product Showcase</h1>
        
        <div id="loginArea">
            <input type="password" id="adminPass" placeholder="Enter Admin Pin">
            <button class="btn-main" onclick="checkAdmin()">Login</button>
        </div>
    </div>

    <div id="adminPanel">
        <h2 style="margin-top:0;">Add New Product</h2>
        <input type="text" id="pName" placeholder="Product Name">
        <input type="text" id="pPrice" placeholder="Price (e.g. 1500 Rs)">
        <input type="text" id="pImg" placeholder="Direct Image Link (.jpg)">
        <input type="text" id="pLink" placeholder="AliExpress Product Link">
        <select id="pStatus">
            <option value="Public">Public</option>
            <option value="Hidden">Hidden</option>
        </select>
        <button class="btn-main" id="uploadBtn" onclick="addProduct()">Upload to Sheet</button>
    </div>

    <div class="grid" id="productGrid">
        <p>Loading products...</p>
    </div>

    <script>
        const scriptURL = 'https://script.google.com/macros/s/AKfycbxcnwoQYT1FbhmVAZr1_IP2dQJPOz6KzklD0h2licXBBv44lQLHRqtiqXK-u_xNY6Oh9A/exec'; 

        let allData = [];

        function toggleLogin() {
            const loginArea = document.getElementById('loginArea');
            loginArea.style.display = (loginArea.style.display === 'block') ? 'none' : 'block';
        }

        async function loadData() {
            try {
                const response = await fetch(scriptURL);
                allData = await response.json();
                renderUI(false); 
            } catch (error) {
                console.error('Error:', error);
                document.getElementById('productGrid').innerHTML = "Failed to load products. Please check Script URL.";
            }
        }

        function renderUI(isAdmin) {
            const grid = document.getElementById('productGrid');
            grid.innerHTML = '';
            
            if (allData.length === 0) {
                grid.innerHTML = "<p>No products found in the sheet.</p>";
                return;
            }

            allData.forEach(item => {
                if(!isAdmin && item.Status !== 'Public') return;

                const orderLink = item.ProductLink || item.Link || '#';

                grid.innerHTML += `
                    <div class="card">
                        ${isAdmin ? <span class="status-tag">${item.Status}</span> : ''}
                        <img src="${item.ImageURL}" class="product-img" onerror="this.src='https://via.placeholder.com/300x200?text=No+Image'">
                        <h3 style="margin:0;">${item.ProductName}</h3>
                        <p class="price">${item.Price}</p>
                        <a href="${orderLink}" target="_blank" class="btn-order">Order Now</a>
                    </div>`;
            });
        }

        function checkAdmin() {
            const pass = document.getElementById('adminPass').value;
            if(pass === "1234") { 
                document.getElementById('adminPanel').style.display = 'block';
                document.getElementById('loginArea').style.display = 'none';
                renderUI(true);
            } else {
                alert("Wrong Password!");
            }
        }

        async function addProduct() {
            const btn = document.getElementById('uploadBtn');
            const pName = document.getElementById('pName').value;
            const pPrice = document.getElementById('pPrice').value;
            const pImg = document.getElementById('pImg').value;
            const pLink = document.getElementById('pLink').value; 
            const pStatus = document.getElementById('pStatus').value;

            if(!pName || !pPrice || !pImg || !pLink) { alert("Fill all fields!"); return; }

            btn.innerText = "Uploading...";
            btn.disabled = true;

            const newProduct = { name: pName, price: pPrice, image: pImg, link: pLink, status: pStatus };

            try {
                await fetch(scriptURL, { method: 'POST', body: JSON.stringify(newProduct) });
                alert("Product Added!");
                location.reload();
            } catch (e) {
                alert("Error uploading.");
                btn.disabled = false;
                btn.innerText = "Upload to Sheet";
            }
        }

        // Initialize loading
        loadData();
    </script>
</body>
</html>

